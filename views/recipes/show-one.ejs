<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head', { title:recipe.name, stylesheets:['dashboard'] }) %>
</head>
<body>
    <%- include('../partials/headbar.ejs') %>
    <%- include('./partials/nav.ejs', {classList:'show', page:'Recipes'}) %>

    <main>
        <header>
            <h1><%= recipe.title %></h1>
            <div class="chips">
                <% if (recepe.prepTime) { %>
                    <div class="chip"><svg></svg>Prep Time: <%= recipe.prepTime %></div> 
                <% } %>
                <% if (recepe.cookTime) { %>
                    <div class="chip"><svg></svg>Cook Time: <%= recipe.cookTime %></div>
                <% } %>
                <% if (recepe.servings) { %>
                    <div class="chip"><svg></svg>Servings: <%= recipe.servings %></div>
                <% } %>
            </div>
            <div class="action-block">
                <a href="/users/favorite/<%= r._id %>?_method=PUT" class="favorite"><svg></svg></a>
                <button id="action-btn">View Full Recipe</button>
            </div>
        </header>

        <section id="ingredients">
            <div class="section-head">
                <h2>ingredients</h2>
                <div><%= recipe.ingredients.length %></div>
            </div>
            <div class="ingredients-grid">
                <% recipe.ingredients.map((i,idx) => { %>
                    <% const inPantry = user.pantry.find(item => item._id===i._id) %>
                    <div class="ingredient card" name="<%= i.name %>" listNumber="<%= idx %>">
                        <input type="checkbox" <%= i.checked && "checked" %> />
                        <p><%= inPantry?.quantity || '' %></p>
                        <p><%= i.name %></p>
                        <% if (i.img) { %>
                            <img src="<%= i.img %>" alt="<%= i.name %>">
                        <% } else { %>
                            <img src="/no-img.svg">
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>

        <section id="photos">
            <div class="section-head">
                <h2>ingredients</h2>
            </div>
            <div class="photo-viewer">
                <div class="prev"></div>
                <div class="big"></div>
                <div class="next"></div>
                <div class="thumbnails">
                    <% if (recipe.photos) { %>
                        <% recipe.photos.map(photo => { %>
                            <img src="<%= photo.url %>" alt="<%= photo.title || recipe.title %>">
                        <% }) %>
                    <% } else { %>
                        <img src="/no-img.svg">
                    <% } %>
                </div>
            </div>
        </section>

        <section id="instructions">
            <div class="section-head">
                <h2>Instructions</h2>
                <div class="view-full">
                    <svg></svg>
                </div>
            </div>
            <div class="instructions-grid">
                <% recipe.instructions.map((i,idx) => { %>
                    <div class="instruction card" name="<%= i.title %>" listNumber="<%= idx %>">
                        <input type="checkbox" <%= i.checked && "checked" %> />
                        <p><%= i.order %></p>
                        <p><%= i.title %></p>
                        <% if (recipe.photos) { %>
                            <img src="<%= i.img %>" alt="<%= i.title %>">
                        <% } else { %>
                            <img src="/no-img.svg">
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        
        <section id="notes">
            <div class="section-head">
                <h2>Notes</h2>
                <button class="view-full">
                    <svg></svg>
                </button>
            </div>
            <div class="notes-grid">
                <textarea name="notes" id="notes">
                    <%= recipe.notes || '' %>
                </textarea>
            </div>
        </section>

        <article>

        </article>
    </main>
</body>
</html>